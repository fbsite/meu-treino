<!DOCTYPE html>
<html lang="pt-BR">
<head>

<!-- Favicon .ico -->
  <link rel="icon" type="image/x-icon" href="https://i.supaimg.com/e7c4bf0e-aa4f-48ab-946d-edfa535b391a.png">
  <link rel="shortcut icon" href=https://i.supaimg.com/e7c4bf0e-aa4f-48ab-946d-edfa535b391a.png">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Plano Performance - Fábio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #111827; color: white; }
        .bg-gray-800 { background-color: #1F2937; }
        .bg-gray-700 { background-color: #374151; }
        .border-gray-700 { border-color: #374151; }
        .text-cyan-400 { color: #22D3EE; }
        .bg-cyan-500 { background-color: #06B6D4; }
        .bg-cyan-600 { background-color: #0891B2; }
        .bg-green-500 { background-color: #10B981; }
        .bg-green-900\/50 { background-color: rgba(6, 78, 59, 0.5); }
        .dropdown-content { display: none; }
        .dropdown-content.show { display: block; }
        input[type="number"] { -moz-appearance: textfield; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        .chart-container { position: relative; height: 300px; width: 100%; }
        .modal { display: none; }
        .modal.show { display: flex; }
        .animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }
    </style>
</head>
<body class="p-4">
    <div class="max-w-2xl mx-auto">
        <!-- Cabeçalho -->
        <header class="text-center mb-6">
            <div class="flex items-center justify-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-cyan-400"><path d="m6.5 6.5 11 11"/><path d="m21 21-1-1"/><path d="m3 3 1 1"/><path d="m18 22 4-4"/><path d="m6 2 4 4"/><path d="m3 10 7-7"/><path d="m14 21 7-7"/><path d="M12 12m-3 0a3 3 0 1 1 6 0 3 3 0 1 1-6 0"/></svg>
                <h1 class="text-3xl font-bold uppercase tracking-tighter">Plano Performance</h1>
            </div>
            <h2 class="text-xl font-semibold text-cyan-400 mt-1">para Fábio</h2>
            <p id="daily-quote" class="text-gray-400 italic mt-3 text-sm">"Onde não há esforço, não há progresso."</p>
        </header>

        <!-- Progresso Total -->
        <div class="bg-gray-800 p-4 rounded-xl border border-gray-700 mb-6 shadow-lg">
            <h3 class="text-sm font-bold text-cyan-400 mb-2 uppercase">Ciclo Upper-Mass Avançado</h3>
            <div class="flex justify-between items-center mb-1">
                <span id="completed-workouts-text" class="text-xs font-mono">0/54 treinos</span>
                <span id="total-progress-percent" class="text-xs font-bold">0%</span>
            </div>
            <div class="w-full bg-gray-700 rounded-full h-3 mb-3">
                <div id="total-progress-bar" class="bg-cyan-500 h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>
            <div class="grid grid-cols-2 text-[10px] text-gray-400 uppercase tracking-widest">
                <div class="flex items-center gap-1">
                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-cyan-400"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>
                    <span>Início: 29/12/2025</span>
                </div>
                <div class="flex items-center gap-1 justify-end">
                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-cyan-400"><path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/><line x1="4" x2="4" y1="22" y2="15"/></svg>
                    <span>Fim: 01/03/2026</span>
                </div>
            </div>
        </div>

        <!-- Menu -->
        <div class="flex bg-gray-800 rounded-lg p-1 mb-6 shadow-inner">
            <button data-view="treino" class="view-tab w-1/3 py-2 rounded-md text-sm font-bold transition-all bg-cyan-600">TREINO</button>
            <button data-view="dieta" class="view-tab w-1/3 py-2 rounded-md text-sm font-bold transition-all bg-transparent">DIETA</button>
            <button data-view="progresso" class="view-tab w-1/3 py-2 rounded-md text-sm font-bold transition-all bg-transparent">PROGRESSO</button>
        </div>

        <!-- Views -->
        <div id="view-content">
            <!-- Treino -->
            <div id="treino-view" class="view active-view">
                <div class="mb-4 relative">
                    <button id="workout-select-button" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-left flex justify-between items-center hover:bg-gray-700 transition">
                        <span id="selected-workout-text" class="font-bold text-sm">Carregando...</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/></svg>
                    </button>
                    <div id="workout-dropdown" class="dropdown-content absolute top-full left-0 right-0 bg-gray-800 border border-gray-700 mt-1 rounded-lg z-20 shadow-2xl max-h-80 overflow-y-auto"></div>
                </div>
                
                <div id="weekly-calendar" class="bg-gray-800 p-4 rounded-xl border border-gray-700 mb-6 overflow-hidden">
                    <div class="grid grid-cols-6 gap-1" id="calendar-days"></div>
                </div>

                <div id="warmup-section" class="bg-gray-800 p-4 rounded-xl border border-gray-700 mb-6"></div>
                <div id="workout-day-content"></div>
            </div>

            <!-- Dieta -->
            <div id="dieta-view" class="view hidden"></div>

            <!-- Progresso -->
            <div id="progresso-view" class="view hidden"></div>
        </div>

        <!-- Timer Modal -->
        <div id="timer-modal" class="modal fixed inset-0 bg-black/90 items-center justify-center z-50">
            <div class="bg-gray-800 rounded-3xl p-8 text-center flex flex-col items-center border border-cyan-500/30 shadow-[0_0_50px_rgba(6,182,212,0.2)]">
                <div class="animate-pulse mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-cyan-400"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                </div>
                <h3 class="text-xl font-bold uppercase tracking-widest text-gray-400">Descanso</h3>
                <p id="timer-time" class="text-8xl font-mono font-bold text-white my-6">0:00</p>
                <button id="timer-stop-button" class="bg-red-500/20 hover:bg-red-500 text-red-500 hover:text-white border border-red-500 font-bold py-3 px-10 rounded-full transition-all">Pular</button>
            </div>
        </div>

        <!-- Image Modal -->
        <div id="image-modal" class="modal fixed inset-0 bg-black/95 items-center justify-center z-50">
             <div class="relative p-2 w-full max-w-lg">
                 <button id="image-modal-close" class="absolute -top-10 right-0 text-white hover:text-cyan-400"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button>
                 <img id="modal-image-element" src="" alt="Dica" class="w-full rounded-2xl shadow-2xl border border-gray-700" />
             </div>
        </div>

        <footer class="text-center mt-12 mb-6">
            <p class="text-gray-600 text-[10px] uppercase tracking-[0.3em]">Built for performance. Version 7.0</p>
        </footer>
    </div>

    <script>
        // --- CONFIGURAÇÃO DO NOVO TREINO ABCDEF ---
        const initialWorkouts = [
            { id: 'a', day: 'Segunda', name: 'A: Peito & Deltoide Frontal (Força)', exercises: [
                { name: 'Supino Reto Barra', sets: 5, reps: '5', rest: 150, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Barbell-Bench-Press.gif', technique: 'Foco total em carga - Explosão' },
                { name: 'Supino Inclinado Halteres', sets: 4, reps: '8-10', rest: 90, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Dumbbell-Incline-Bench-Press.gif', technique: 'Controlar descida 3s' },
                { name: 'Desenvolvimento Militar Barra', sets: 4, reps: '6-8', rest: 120, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Barbell-Overhead-Press.gif', technique: 'Tronco firme, sem impulso' },
                { name: 'Crucifixo Máquina / Polia', sets: 3, reps: '12-15', rest: 60, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Pec-Deck-Fly.gif', technique: 'Pico de contração 2s' },
                { name: 'Elevação Frontal Polia', sets: 3, reps: '12', rest: 60, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Cable-Front-Raise.gif' }
            ]},
            { id: 'b', day: 'Terça', name: 'B: Costas & Deltoide Posterior (Força)', exercises: [
                { name: 'Levantamento Terra (Sumô ou Tradicional)', sets: 5, reps: '5', rest: 180, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Barbell-Deadlift.gif', technique: 'Base da força - Escápulas travadas' },
                { name: 'Remada Curvada Barra', sets: 4, reps: '8', rest: 120, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Barbell-Bent-Over-Row.gif', technique: 'Tronco paralelo ao chão' },
                { name: 'Barra Fixa (com peso extra)', sets: 4, reps: 'Falha', rest: 90, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Pull-up.gif', technique: 'Amplitude máxima' },
                { name: 'Crucifixo Invertido Halteres', sets: 4, reps: '15', rest: 60, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Dumbbell-Rear-Lateral-Raise.gif' },
                { name: 'Encolhimento Barra (pela frente)', sets: 4, reps: '12', rest: 60, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Barbell-Shrug.gif', technique: 'Segurar 2s no topo' }
            ]},
            { id: 'c', day: 'Quarta', name: 'C: Inferiores (Quadríceps Focus)', exercises: [
                { name: 'Agachamento Livre', sets: 4, reps: '8', rest: 150, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Barbell-Squat.gif', technique: 'Descer abaixo de 90 graus' },
                { name: 'Leg Press 45 (Pés baixos)', sets: 4, reps: '12', rest: 90, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/03/Leg-Press.gif', technique: 'Sem estender totalmente joelhos' },
                { name: 'Cadeira Extensora', sets: 4, reps: '15 + DropSet', rest: 60, image: 'https://www.mundoboaforma.com.br/wp-content/uploads/2020/12/cadeira-extensora.gif' },
                { name: 'Passada / Avanço Halteres', sets: 3, reps: '20 passos', rest: 90, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Dumbbell-Lunge.gif' },
                { name: 'Panturrilha em Pé', sets: 5, reps: '15-20', rest: 45, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Standing-Calf-Raise.gif' }
            ]},
            { id: 'd', day: 'Quinta', name: 'D: Braços (Tríceps & Bíceps)', exercises: [
                { name: 'Supino Fechado (Tríceps)', sets: 4, reps: '8', rest: 90, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Close-Grip-Bench-Press.gif', technique: 'Cotovelos raspando nas costelas' },
                { name: 'Rosca Direta Barra W', sets: 4, reps: '8-10', rest: 90, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/EZ-Bar-Curl.gif', technique: 'Sem balançar o tronco' },
                { name: 'Tríceps Testa + Supino Francês', sets: 3, reps: '10+10', rest: 75, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/EZ-Bar-Skullcrusher.gif', technique: 'Combo para destruir o tríceps' },
                { name: 'Rosca Martelo Halteres', sets: 3, reps: '12', rest: 60, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/04/Hammer-Curl.gif' },
                { name: 'Tríceps Corda Polia', sets: 3, reps: '15 + DropSet', rest: 45, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Triceps-Pushdown.gif' },
                { name: 'Rosca Inversa Barra', sets: 3, reps: '15', rest: 45, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Reverse-Curl.gif', technique: 'Foco antebraço' }
            ]},
            { id: 'e', day: 'Sexta', name: 'E: Peito & Costas (Volume/Supersets)', exercises: [
                { name: 'Supino Inclinado Barra', sets: 4, reps: '12', rest: 90, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Incline-Barbell-Bench-Press.gif' },
                { name: 'Puxada Frente Aberta', sets: 4, reps: '12', rest: 90, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Lat-Pulldown.gif' },
                { name: 'Dips (Paralelas)', sets: 3, reps: 'Falha', rest: 60, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Dip.gif' },
                { name: 'Remada Sentada Neutra', sets: 3, reps: '15', rest: 60, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Seated-Cable-Row.gif' },
                { name: 'Pullover Halter', sets: 3, reps: '15', rest: 60, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Dumbbell-Pullover.gif' }
            ]},
            { id: 'f', day: 'Sábado', name: 'F: Ombros, Core & Braços (Pump)', exercises: [
                { name: 'Desenvolvimento Arnold', sets: 4, reps: '10-12', rest: 90, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Arnold-Press.gif' },
                { name: 'Elevação Lateral Halteres', sets: 5, reps: '15-20', rest: 45, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Dumbbell-Lateral-Raise.gif', technique: 'Rest-Pause na última' },
                { name: 'Face Pull', sets: 4, reps: '20', rest: 45, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Cable-Face-Pull.gif' },
                { name: 'Rosca Concentrada', sets: 3, reps: '12', rest: 45, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Concentration-Curl.gif' },
                { name: 'Abdominal Roda', sets: 4, reps: 'Falha', rest: 60, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Ab-Roller.gif' },
                { name: 'Prancha Isométrica', sets: 3, reps: '1 min', rest: 60, image: 'https://fitnessprogramer.com/wp-content/uploads/2021/02/Plank.gif' }
            ]},
        ];

        const mealPlanData = {
            totalCalories: 2050,
            macros: { protein: 165, carbs: 190, fats: 65 },
            meals: [
                { name: "07:00 - Café da manhã", macros: "30g P | 40g C | 12g G", options: [{ id: 1, items: [{ food: "4 claras + 2 ovos inteiros", qty: "mexidos" }, { food: "Aveia", qty: "40g" }, { food: "Banana", qty: "1 un" }] }] },
                { name: "10:00 - Lanche manhã", macros: "35g P | 30g C | 9g G", options: [{ id: 1, items: [{ food: "Frango desfiado", qty: "150g" }, { food: "Pão integral", qty: "2 fatias" }, { food: "Pasta amendoim", qty: "10g" }] }] },
                { name: "13:00 - Almoço", macros: "40g P | 30g C | 12g G", options: [{ id: 1, items: [{ food: "Peito de frango / Patinho", qty: "150g" }, { food: "Arroz integral", qty: "100g" }, { food: "Salada verde + Azeite", qty: "10g" }] }] },
                { name: "16:30 - Pré-treino", macros: "35g P | 35g C | 5g G", options: [{ id: 1, items: [{ food: "Batata-doce / Mandioca", qty: "150g" }, { food: "Peito de frango / Peixe", qty: "150g" }] }] },
                { name: "19:00 - Pós-treino", macros: "25g P | 25g C | 1g G", options: [{ id: 1, items: [{ food: "Whey Protein", qty: "1 scoop" }, { food: "Banana", qty: "1 un" }] }] },
                { name: "22:00 - Jantar / Ceia", macros: "30g P | 10g C | 15g G", options: [{ id: 1, items: [{ food: "Peixe (Tilápia/Salmão)", qty: "200g" }, { food: "Brócolis / Abobrinha", qty: "Livre" }, { food: "Castanhas", qty: "10g" }] }] }
            ],
            rules: [
                { icon: 'dumbbell', text: "Membros Superiores: Prioridade total no volume de treino." },
                { icon: 'droplet', text: "Água: 2,6 litros por dia no mínimo." },
                { icon: 'zap', text: "HIIT: 3x na semana (15 min) para auxiliar na definição (10% BF)." },
                { icon: 'pizza', text: "Uma refeição livre semanal controlada." }
            ]
        };

        // --- ESTADO & LÓGICA ---
        const COOKIE_NAME = 'workoutAppState_v7.0';
        const PLAN_ID = 'v7.0_291225';
        const TOTAL_WORKOUTS = 54;

        let state = {
            view: 'treino',
            workoutsData: [],
            selectedWorkoutId: 'a',
            completedWorkoutsCount: 0,
            warmupState: { cardio: false, mobility: false },
            cardioState: { h1: false, h2: false, h3: false },
            measurementHistory: [{ date: 'Início', peso: 74.7, gordura: 21.1 }],
            bodyMeasurements: {},
            goals: { weight: 70, bodyFat: 10 },
            timer: { active: false, timeLeft: 0, interval: null }
        };

        // Funções de Cookie
        function setCookie(value) {
            const date = new Date();
            date.setFullYear(date.getFullYear() + 1);
            document.cookie = `${COOKIE_NAME}=${encodeURIComponent(JSON.stringify(value))}; expires=${date.toUTCString()}; path=/; SameSite=Lax`;
        }

        function getCookie() {
            const match = document.cookie.match(new RegExp('(^| )' + COOKIE_NAME + '=([^;]+)'));
            return match ? JSON.parse(decodeURIComponent(match[2])) : null;
        }

        // Inicialização
        function init() {
            const saved = getCookie();
            if (saved) {
                state = { ...state, ...saved };
                // Se o treino salvo for de outra versão, reinicializamos os dados de exercício mas mantemos o progresso
                state.workoutsData = initializeSetDetails(state.workoutsData.length === initialWorkouts.length ? state.workoutsData : initialWorkouts);
            } else {
                state.workoutsData = initializeSetDetails(initialWorkouts);
            }

            setupTabs();
            render();
            
            const today = new Date().getDay(); // 0 Dom, 1 Seg...
            const mapDay = ['a', 'a', 'b', 'c', 'd', 'e', 'f'];
            state.selectedWorkoutId = mapDay[today] || 'a';
            renderWorkout();
        }

        function initializeSetDetails(workouts) {
            return workouts.map(w => ({
                ...w,
                exercises: w.exercises.map(ex => ({
                    ...ex,
                    setDetails: ex.setDetails || Array.from({ length: ex.sets }, () => ({ completed: false, weight: '' }))
                }))
            }));
        }

        // Renderização Geral
        function render() {
            updateProgressHeader();
            if (state.view === 'treino') renderWorkout();
            if (state.view === 'dieta') renderDiet();
            if (state.view === 'progresso') renderProgress();
        }

        function updateProgressHeader() {
            const progress = (state.completedWorkoutsCount / TOTAL_WORKOUTS) * 100;
            document.getElementById('completed-workouts-text').textContent = `${state.completedWorkoutsCount}/${TOTAL_WORKOUTS} treinos`;
            document.getElementById('total-progress-percent').textContent = `${Math.round(progress)}%`;
            document.getElementById('total-progress-bar').style.width = `${progress}%`;
        }

        function setupTabs() {
            document.querySelectorAll('.view-tab').forEach(btn => {
                btn.onclick = () => {
                    state.view = btn.dataset.view;
                    document.querySelectorAll('.view-tab').forEach(b => b.classList.remove('bg-cyan-600'));
                    btn.classList.add('bg-cyan-600');
                    render();
                };
            });
        }

        // --- ABA TREINO ---
        function renderWorkout() {
            const view = document.getElementById('treino-view');
            const dropdown = document.getElementById('workout-dropdown');
            const btnText = document.getElementById('selected-workout-text');
            const workout = state.workoutsData.find(w => w.id === state.selectedWorkoutId);

            btnText.textContent = workout.name;
            dropdown.innerHTML = state.workoutsData.map(w => `
                <div onclick="selectWorkout('${w.id}')" class="p-4 hover:bg-gray-700 cursor-pointer border-b border-gray-700 text-sm ${w.id === state.selectedWorkoutId ? 'text-cyan-400 font-bold' : ''}">
                    ${w.name}
                </div>
            `).join('');

            document.getElementById('workout-select-button').onclick = () => dropdown.classList.toggle('show');

            // Calendário
            const weekDays = ["SEG", "TER", "QUA", "QUI", "SEX", "SÁB"];
            document.getElementById('calendar-days').innerHTML = weekDays.map((d, i) => `
                <div class="p-2 rounded-lg text-center ${workout.id === state.workoutsData[i].id ? 'bg-cyan-600' : 'bg-gray-700'}">
                    <p class="text-[10px] font-bold">${d}</p>
                </div>
            `).join('');

            // Aquecimento
            document.getElementById('warmup-section').innerHTML = `
                <h4 class="text-xs font-bold text-cyan-400 mb-3 uppercase tracking-tighter">Aquecimento Pré-Treino</h4>
                <div class="space-y-2">
                    <div onclick="toggleWarmup('cardio')" class="flex items-center justify-between p-3 rounded-xl border border-gray-700 cursor-pointer ${state.warmupState.cardio ? 'bg-green-900/30 border-green-500' : 'bg-gray-900'}">
                        <div class="flex items-center gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-cyan-400"><path d="M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2"/><path d="M9.6 4.6A2 2 0 1 1 11 8H2"/><path d="M12.6 19.4A2 2 0 1 0 14 16H2"/></svg><span class="text-sm">Cardio Leve (5 min)</span></div>
                        ${state.warmupState.cardio ? '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-green-500"><path d="M20 6 9 17l-5-5"/></svg>' : ''}
                    </div>
                    <div onclick="toggleWarmup('mobility')" class="flex items-center justify-between p-3 rounded-xl border border-gray-700 cursor-pointer ${state.warmupState.mobility ? 'bg-green-900/30 border-green-500' : 'bg-gray-900'}">
                        <div class="flex items-center gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-cyan-400"><path d="M17 2.1l4 4-4 4"/><path d="M3 12.2v-2a4 4 0 0 1 4-4h12"/><path d="M7 21.9l-4-4 4-4"/><path d="M21 11.8v2a4 4 0 0 1-4 4H5"/></svg><span class="text-sm">Mobilidade Articular</span></div>
                        ${state.warmupState.mobility ? '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-green-500"><path d="M20 6 9 17l-5-5"/></svg>' : ''}
                    </div>
                </div>
            `;

            // Exercícios
            const content = document.getElementById('workout-day-content');
            content.innerHTML = workout.exercises.map((ex, exIdx) => `
                <div class="bg-gray-800 rounded-2xl p-5 mb-4 border border-gray-700 shadow-xl">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h4 class="font-bold text-lg leading-tight">${ex.name}</h4>
                            <p class="text-xs text-gray-400 mt-1">${ex.sets} séries • ${ex.reps} reps • ${ex.rest}s descanso</p>
                            ${ex.technique ? `<p class="text-[10px] text-amber-400 font-semibold mt-1 uppercase italic">${ex.technique}</p>` : ''}
                        </div>
                        <img onclick="openImg('${ex.image}')" src="${ex.image}" class="w-16 h-16 rounded-lg object-cover border border-gray-600 shadow-md cursor-pointer">
                    </div>
                    <div class="space-y-2">
                        ${ex.setDetails.map((s, sIdx) => `
                            <div class="flex items-center gap-2">
                                <div class="bg-gray-900 rounded-lg flex-1 flex items-center px-3 py-2 border border-gray-700">
                                    <span class="text-[10px] font-bold text-gray-500 w-8">#${sIdx + 1}</span>
                                    <input type="number" onchange="updateWeight('${workout.id}', ${exIdx}, ${sIdx}, this.value)" value="${s.weight}" placeholder="KG" class="bg-transparent w-full text-center text-sm font-bold focus:outline-none text-cyan-400">
                                </div>
                                <button onclick="toggleSet('${workout.id}', ${exIdx}, ${sIdx}, ${ex.rest})" class="w-10 h-10 rounded-lg flex items-center justify-center transition-all ${s.completed ? 'bg-green-500 text-white' : 'bg-gray-700 text-gray-500'}">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M20 6 9 17l-5-5"/></svg>
                                </button>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('') + `
                <button onclick="finishWorkout()" class="w-full bg-cyan-600 hover:bg-cyan-500 py-4 rounded-2xl font-bold uppercase tracking-widest transition shadow-lg mt-4">Finalizar Treino</button>
            `;
        }

        function selectWorkout(id) {
            state.selectedWorkoutId = id;
            document.getElementById('workout-dropdown').classList.remove('show');
            renderWorkout();
            setCookie(state);
        }

        function toggleWarmup(key) {
            state.warmupState[key] = !state.warmupState[key];
            renderWorkout();
            setCookie(state);
        }

        function toggleSet(wId, exIdx, sIdx, rest) {
            const w = state.workoutsData.find(item => item.id === wId);
            const set = w.exercises[exIdx].setDetails[sIdx];
            set.completed = !set.completed;
            if (set.completed) startTimer(rest);
            renderWorkout();
            setCookie(state);
        }

        function updateWeight(wId, exIdx, sIdx, val) {
            const w = state.workoutsData.find(item => item.id === wId);
            w.exercises[exIdx].setDetails[sIdx].weight = val;
            setCookie(state);
        }

        function finishWorkout() {
            state.completedWorkoutsCount++;
            alert("Treino finalizado! Força bruta, Fábio.");
            render();
            setCookie(state);
        }

        // --- TIMER ---
        function startTimer(sec) {
            clearInterval(state.timer.interval);
            state.timer.timeLeft = sec;
            document.getElementById('timer-modal').classList.add('show');
            
            state.timer.interval = setInterval(() => {
                state.timer.timeLeft--;
                const min = Math.floor(state.timer.timeLeft / 60);
                const s = state.timer.timeLeft % 60;
                document.getElementById('timer-time').textContent = `${min}:${s < 10 ? '0' + s : s}`;
                
                if (state.timer.timeLeft <= 0) stopTimer();
            }, 1000);
        }

        function stopTimer() {
            clearInterval(state.timer.interval);
            document.getElementById('timer-modal').classList.remove('show');
        }
        document.getElementById('timer-stop-button').onclick = stopTimer;

        // --- ABA DIETA ---
        function renderDiet() {
            const view = document.getElementById('dieta-view');
            view.innerHTML = `
                <div class="bg-gray-800 p-6 rounded-3xl border border-gray-700 mb-6 shadow-xl text-center">
                    <h3 class="text-cyan-400 font-bold uppercase text-xs tracking-[0.2em] mb-4">Macros Diários (Cutting)</h3>
                    <div class="flex justify-between items-center px-4">
                        <div><p class="text-2xl font-bold">${mealPlanData.totalCalories}</p><p class="text-[10px] text-gray-400 uppercase">Kcal</p></div>
                        <div class="w-px h-8 bg-gray-700"></div>
                        <div><p class="text-2xl font-bold">${mealPlanData.macros.protein}g</p><p class="text-[10px] text-gray-400 uppercase">Proteína</p></div>
                        <div class="w-px h-8 bg-gray-700"></div>
                        <div><p class="text-2xl font-bold">${mealPlanData.macros.carbs}g</p><p class="text-[10px] text-gray-400 uppercase">Carbos</p></div>
                        <div class="w-px h-8 bg-gray-700"></div>
                        <div><p class="text-2xl font-bold">${mealPlanData.macros.fats}g</p><p class="text-[10px] text-gray-400 uppercase">Gordura</p></div>
                    </div>
                </div>
                <div class="space-y-4">
                    ${mealPlanData.meals.map(m => `
                        <div class="bg-gray-800 p-5 rounded-2xl border border-gray-700 shadow-md">
                            <div class="flex justify-between items-center mb-3">
                                <h4 class="font-bold text-gray-200">${m.name}</h4>
                                <span class="text-[10px] font-mono text-cyan-400 bg-cyan-400/10 px-2 py-1 rounded-md">${m.macros}</span>
                            </div>
                            <ul class="text-sm text-gray-400 space-y-1">
                                ${m.options[0].items.map(i => `
                                    <li class="flex justify-between"><span>${i.food}</span><span class="text-white font-semibold">${i.qty}</span></li>
                                `).join('')}
                            </ul>
                        </div>
                    `).join('')}
                </div>
                <div class="bg-gray-800 p-5 rounded-2xl border border-gray-700 mt-6">
                    <h4 class="text-xs font-bold text-cyan-400 mb-4 uppercase tracking-widest flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1-2.5-2.5Z"/><path d="M8 7h6"/><path d="M8 11h8"/></svg> Regras de Ouro
                    </h4>
                    <ul class="space-y-3">
                        ${mealPlanData.rules.map(r => `
                            <li class="flex items-start gap-3 text-xs text-gray-300">
                                <div class="mt-0.5"><div class="w-1.5 h-1.5 rounded-full bg-cyan-400"></div></div>
                                ${r.text}
                            </li>
                        `).join('')}
                    </ul>
                </div>
            `;
        }

        // --- ABA PROGRESSO ---
        let chartInstance = null;
        function renderProgress() {
            const view = document.getElementById('progresso-view');
            view.innerHTML = `
                <div class="bg-gray-800 p-5 rounded-2xl border border-gray-700 mb-6">
                    <h3 class="text-xs font-bold text-cyan-400 mb-4 uppercase">Bioimpedância Atual</h3>
                    <div class="grid grid-cols-3 gap-3">
                        <div class="bg-gray-900 p-3 rounded-xl text-center border border-gray-700">
                            <p class="text-[10px] text-gray-500 uppercase">Peso</p>
                            <p class="text-lg font-bold">${state.measurementHistory[state.measurementHistory.length - 1].peso}kg</p>
                        </div>
                        <div class="bg-gray-900 p-3 rounded-xl text-center border border-gray-700">
                            <p class="text-[10px] text-gray-500 uppercase">Gordura</p>
                            <p class="text-lg font-bold">${state.measurementHistory[state.measurementHistory.length - 1].gordura}%</p>
                        </div>
                        <div class="bg-gray-900 p-3 rounded-xl text-center border border-gray-700">
                            <p class="text-[10px] text-gray-500 uppercase">Meta</p>
                            <p class="text-lg font-bold text-cyan-400">10%</p>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-800 p-5 rounded-2xl border border-gray-700 mb-6">
                    <h3 class="text-xs font-bold text-cyan-400 mb-4 uppercase">Gráfico de Recomposição</h3>
                    <div class="chart-container"><canvas id="pChart"></canvas></div>
                </div>
                <div class="bg-gray-800 p-5 rounded-2xl border border-gray-700 mb-6">
                    <h3 class="text-xs font-bold text-cyan-400 mb-4 uppercase">Novo Registro</h3>
                    <div class="flex gap-2">
                        <input id="newWeight" type="number" step="0.1" placeholder="PESO" class="bg-gray-900 border border-gray-700 p-3 rounded-xl flex-1 text-center font-bold focus:border-cyan-400 outline-none">
                        <input id="newFat" type="number" step="0.1" placeholder="BF%" class="bg-gray-900 border border-gray-700 p-3 rounded-xl flex-1 text-center font-bold focus:border-cyan-400 outline-none">
                        <button onclick="saveMeasure()" class="bg-cyan-600 px-5 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M5 12h14"/><path d="M12 5v14"/></svg></button>
                    </div>
                </div>
            `;
            initChart();
        }

        function initChart() {
            const ctx = document.getElementById('pChart').getContext('2d');
            if (chartInstance) chartInstance.destroy();
            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: state.measurementHistory.map(h => h.date),
                    datasets: [
                        { label: 'Peso', data: state.measurementHistory.map(h => h.peso), borderColor: '#06B6D4', tension: 0.4 },
                        { label: 'Gordura %', data: state.measurementHistory.map(h => h.gordura), borderColor: '#EF4444', tension: 0.4 }
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { display: false }, x: { grid: { display: false } } }, plugins: { legend: { display: false } } }
            });
        }

        function saveMeasure() {
            const w = document.getElementById('newWeight').value;
            const f = document.getElementById('newFat').value;
            if (w && f) {
                state.measurementHistory.push({ date: new Date().toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' }), peso: parseFloat(w), gordura: parseFloat(f) });
                setCookie(state);
                renderProgress();
            }
        }

        // --- UTILITÁRIOS ---
        function calculateIMC(w) { return (w / (1.7 * 1.7)).toFixed(1); }
        function openImg(src) { document.getElementById('modal-image-element').src = src; document.getElementById('image-modal').classList.add('show'); }
        document.getElementById('image-modal-close').onclick = () => document.getElementById('image-modal').classList.remove('show');
        
        init();
    </script>
</body>
</html>